<!DOCTYPE html>
<html lang="en">
<head>
	<title>從零開始的數鷹生活～呼呦～ 排行榜</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
	<style type="text/css">
	</style>

</head>
<body >
	
	<div class="limiter" >
		<div class="container-table100" style="background: url('images/leaderboard_bg.png') top; background-repeat:repeat-x; background-color:#FFFFFF; padding: 0px 0px">
			<div class="container-table100" style="background: url('images/leaderboard_bg02.png') top; background-repeat:no-repeat;">
					<div class="table100 ver5 m-b-110">
						<table data-vertable="ver5">
							<thead>
								<tr class="row100 head">
									<th class="column100 column1" data-column="column1">排名</th>
									<th class="column100 column2" data-column="column2">名字</th>
									<th class="column100 column3" data-column="column3">分數</th>
								</tr>
							</thead>
							<tbody id = "tbodyRef">
								<tr id="placeholder" class="row100"><td class="column100 column1">呼唷</td><td class="column100 column2">讀取中...</td><td class="column100 column3">等待過久請嘗試重整網頁</td></tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

<!--===============================================================================================-->	
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>

	<script type="text/javascript">
		
		function httpGet(theUrl)
		{
		    var xmlHttp = new XMLHttpRequest();
		    xmlHttp.open("GET", theUrl, false); // false for synchronous request
		    xmlHttp.send(null);
		    return xmlHttp.responseText;
		}

		function httpGetAsync(theUrl, callback)
		{
		    var xmlHttp = new XMLHttpRequest();
		    xmlHttp.onreadystatechange = function() { 
		        if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
		            callback(xmlHttp.responseText);
		    }
		    xmlHttp.open("GET", theUrl, true); // true for asynchronous 
		    xmlHttp.send(null);
		}

		function getCompleteCallback(responseText)
		{
			var jsonData = JSON.parse(responseText);
			if (jsonData == undefined || jsonData.result == undefined || jsonData.result != "success")
			{
				return;
			}

			//Remove placeholder
			placeholder.parentNode.removeChild(placeholder);
			
			//
			var sheet = jsonData.sheet;

			var length = sheet.length;
			for (var i = 0; i < length; i++) 
			{
				var data = sheet[i];
				if (data[1] == "")
				{
					break;
				}

				// console.log(data[0] + ", " + data[1]);

				// Insert a row at the end of table
				var row = tbodyRef.insertRow();
				row.className = "row100";

				// Insert cells at the end of the row
				var cell1 = row.insertCell(0);
				var cell2 = row.insertCell(1);
				var cell3 = row.insertCell(2);

				// Add some text to the new cells:
				cell1.className = "column100 column1";
				cell2.className = "column100 column2";
				cell3.className = "column100 column3";

				cell1.innerHTML = (i + 1);
				cell2.innerHTML = data[0] ;
				cell3.innerHTML = data[1];
			}
		}

		httpGetAsync("https://script.google.com/macros/s/AKfycbzSAi_Enr-zb03DryW0drmmPlEftWcpxDWcwnjBNGg4N36BfRkx/exec?name=''&email=KJLOTHERKFDI&score=-1&saopiwlqo=65535", getCompleteCallback);
	</script>

</body>
</html>